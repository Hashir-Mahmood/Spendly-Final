<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="MauiApp1234.Subscription"
             BackgroundColor="#f4f6f9"
             xmlns:syncfusion="clr-namespace:Syncfusion.Maui.Charts;assembly=Syncfusion.Maui.Charts"
             Title="Subscription">

    <ScrollView>
        <StackLayout Padding="20" Spacing="20">

            <!-- Header with Icons -->
            <Grid Margin="0,10" ColumnDefinitions="Auto,*,Auto,Auto">
                <!-- Menu icon on the left -->
                <Frame Grid.Column="0" CornerRadius="24" Padding="10" HasShadow="False" BackgroundColor="White" HorizontalOptions="CenterAndExpand">
                    <Image Source="ai.png" HeightRequest="20" WidthRequest="20" x:Name="ChatbotIcon"/>
                    <Frame.GestureRecognizers>
                        <TapGestureRecognizer Tapped="ChatbotIcon_Tapped"/>
                    </Frame.GestureRecognizers>
                </Frame>

                <!-- Space in the middle (will automatically expand) -->
                <Grid Grid.Column="1" />

                <!-- Notifications icon -->
                <Frame Grid.Column="2" CornerRadius="24" Padding="10" HasShadow="False" BackgroundColor="White">
                    <Image Source="bell.png" HeightRequest="20" WidthRequest="20" x:Name="NotificationsIcon"/>
                    <Frame.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnNotificationsIconTapped"/>
                    </Frame.GestureRecognizers>
                </Frame>

                <!-- Settings icon -->
                <Frame Grid.Column="3" CornerRadius="20" Padding="10" HasShadow="False" BackgroundColor="White" Margin="10,0,0,0">
                    <Image Source="settings.png" HeightRequest="20" WidthRequest="20" x:Name="SettingsIcon"/>
                    <Frame.GestureRecognizers>
                        <TapGestureRecognizer Tapped="SettingsIcon_Tapped"/>
                    </Frame.GestureRecognizers>
                </Frame>
            </Grid>

            <!-- Header -->
            <Label Text="Subscriptions" FontSize="28" FontAttributes="Bold" HorizontalOptions="Center"/>

            <!-- Total Amount Card -->
            <Frame CornerRadius="10" Padding="15" BackgroundColor="White">
                <StackLayout>
                    <StackLayout Orientation="Horizontal">
                        <Label Text="Monthly Total:" FontAttributes="Bold" FontSize="16"/>
                        <Label Text="+12.4%" TextColor="#6f61ef" FontAttributes="Bold" HorizontalOptions="EndAndExpand"/>
                    </StackLayout>
                    <Label Text="Â£89.99" FontSize="30" FontAttributes="Bold" Margin="0,5,0,10"/>
                    <Label Text="see subscription analytics >>" TextColor="#6f61ef" HorizontalTextAlignment="Start">
                        <Label.GestureRecognizers>
                            <TapGestureRecognizer Tapped="AnalyticsLabel_Tapped"/>
                        </Label.GestureRecognizers>
                    </Label>
                </StackLayout>
            </Frame>

            <!-- Enhanced Warning Banner with Similar Subscriptions -->
            <Frame CornerRadius="10" Padding="15" BackgroundColor="#FFF3E0" BorderColor="#FF9800" HasShadow="False" x:Name="WarningBanner">
                <StackLayout Spacing="10">
                    <Grid ColumnDefinitions="Auto,*,Auto">
                        <Label Text="âš " FontSize="18" FontAttributes="Bold" TextColor="#FF9800" Grid.Column="0" VerticalOptions="Center"/>
                        <Label Text="Similar subscriptions detected" TextColor="#FF9800" FontAttributes="Bold" 
                               Grid.Column="1" VerticalOptions="Center" Margin="10,0,0,0"/>
                        <Button Grid.Column="2" Text="âœ•" BackgroundColor="Transparent" TextColor="#FF9800" 
                                FontSize="16" WidthRequest="30" HeightRequest="30" Padding="0" VerticalOptions="Center"
                                Clicked="DismissWarning_Clicked"/>
                    </Grid>

                    <!-- Similar Subscriptions Details -->
                    <Grid ColumnDefinitions="Auto,*,Auto" Margin="25,0,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Netflix Premium and Netflix Standard -->
                        <Image Source="netflix.png" HeightRequest="25" WidthRequest="25" Grid.Row="0" Grid.Column="0" 
                               VerticalOptions="Center" HorizontalOptions="Start"/>
                        <Label Text="Netflix Premium + Netflix Standard" TextColor="#FF9800" Grid.Row="0" Grid.Column="1" 
                               VerticalOptions="Center" Margin="10,0,0,0"/>
                        <Label Text="Â£26.98/mo" TextColor="#FF9800" Grid.Row="0" Grid.Column="2" 
                               VerticalOptions="Center" HorizontalOptions="End" FontAttributes="Bold"/>

                        <!-- Recommendation -->
                        <Label Text="ðŸ’¡ Recommendation: Consider keeping only Netflix Premium to save Â£10.99/mo" 
                               TextColor="#FF9800" Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="3" 
                               Margin="0,5,0,0"/>
                    </Grid>

                    <Button Text="View Optimization Plan" BackgroundColor="#FF9800" TextColor="White"
                            CornerRadius="20" HeightRequest="40" FontAttributes="Bold" 
                            HorizontalOptions="Center" Margin="0,5,0,0"
                            Clicked="ViewOptimizationPlan_Clicked"/>
                </StackLayout>
            </Frame>

            <!-- Category Filter Buttons -->
            <Frame CornerRadius="10" Padding="10" BackgroundColor="White">
                <ScrollView Orientation="Horizontal" HorizontalScrollBarVisibility="Never">
                    <HorizontalStackLayout Spacing="10">
                        <Border BackgroundColor="#6f61ef" StrokeShape="RoundRectangle 20" Padding="15,8">
                            <Label Text="All" TextColor="White" FontSize="14" FontAttributes="Bold"/>
                        </Border>
                        <Border BackgroundColor="#f0f0f0" StrokeShape="RoundRectangle 20" Padding="15,8">
                            <Label Text="Entertainment" TextColor="#444" FontSize="14"/>
                        </Border>
                        <Border BackgroundColor="#f0f0f0" StrokeShape="RoundRectangle 20" Padding="15,8">
                            <Label Text="Fitness" TextColor="#444" FontSize="14"/>
                        </Border>
                        <Border BackgroundColor="#f0f0f0" StrokeShape="RoundRectangle 20" Padding="15,8">
                            <Label Text="Shopping" TextColor="#444" FontSize="14"/>
                        </Border>
                        <Border BackgroundColor="#f0f0f0" StrokeShape="RoundRectangle 20" Padding="15,8">
                            <Label Text="Music" TextColor="#444" FontSize="14"/>
                        </Border>
                        <Border BackgroundColor="#f0f0f0" StrokeShape="RoundRectangle 20" Padding="15,8">
                            <Label Text="Productivity" TextColor="#444" FontSize="14"/>
                        </Border>
                    </HorizontalStackLayout>
                </ScrollView>
            </Frame>

            <!-- Subscription Items -->
            <!-- Netflix Premium -->
            <Frame CornerRadius="10" Padding="15" BackgroundColor="White">
                <Grid RowDefinitions="Auto,Auto" ColumnDefinitions="Auto,*,Auto">
                    <Image Grid.RowSpan="2" Source="netflix.png" HeightRequest="45" WidthRequest="45" 
                           Margin="0,0,15,0" Aspect="AspectFit"/>
                    <Label Grid.Column="1" Text="Netflix Premium" FontAttributes="Bold" TextColor="Black" FontSize="16"/>
                    <Label Grid.Column="1" Grid.Row="1" Text="Renews 15 Apr, 2024" TextColor="#666" FontSize="12"/>
                    <VerticalStackLayout Grid.Column="2" Grid.RowSpan="2" HorizontalOptions="End" VerticalOptions="Center">
                        <Label Text="Â£15.99/m" FontAttributes="Bold" TextColor="Black" HorizontalOptions="End" FontSize="16"/>
                        <Label Text="â†‘ +1.1" TextColor="#ff5252" FontSize="12" HorizontalOptions="End"/>
                    </VerticalStackLayout>
                </Grid>
            </Frame>

            <!-- Netflix Standard -->
            <Frame CornerRadius="10" Padding="15" BackgroundColor="White">
                <Grid RowDefinitions="Auto,Auto" ColumnDefinitions="Auto,*,Auto">
                    <Image Grid.RowSpan="2" Source="netflix.png" HeightRequest="45" WidthRequest="45" 
                           Margin="0,0,15,0" Aspect="AspectFit"/>
                    <Label Grid.Column="1" Text="Netflix Standard" FontAttributes="Bold" TextColor="Black" FontSize="16"/>
                    <Label Grid.Column="1" Grid.Row="1" Text="Renews 3 May, 2024" TextColor="#666" FontSize="12"/>
                    <VerticalStackLayout Grid.Column="2" Grid.RowSpan="2" HorizontalOptions="End" VerticalOptions="Center">
                        <Label Text="Â£10.99/m" FontAttributes="Bold" TextColor="Black" HorizontalOptions="End" FontSize="16"/>
                        <Label Text="â†‘ +0.5" TextColor="#ff5252" FontSize="12" HorizontalOptions="End"/>
                    </VerticalStackLayout>
                </Grid>
            </Frame>

            <!-- Spotify -->
            <Frame CornerRadius="10" Padding="15" BackgroundColor="White">
                <Grid RowDefinitions="Auto,Auto" ColumnDefinitions="Auto,*,Auto">
                    <Image Grid.RowSpan="2" Source="spotify.png" HeightRequest="45" WidthRequest="45" 
                           Margin="0,0,15,0" Aspect="AspectFit"/>
                    <Label Grid.Column="1" Text="Spotify Family" FontAttributes="Bold" TextColor="Black" FontSize="16"/>
                    <Label Grid.Column="1" Grid.Row="1" Text="Renews 28 Mar, 2024" TextColor="#666" FontSize="12"/>
                    <VerticalStackLayout Grid.Column="2" Grid.RowSpan="2" HorizontalOptions="End" VerticalOptions="Center">
                        <Label Text="Â£17.99/mo" FontAttributes="Bold" TextColor="Black" HorizontalOptions="End" FontSize="16"/>
                        <Label Text="â†“ -5.01" TextColor="#4CAF50" FontSize="12" HorizontalOptions="End"/>
                    </VerticalStackLayout>
                </Grid>
            </Frame>

            <!-- Adobe -->
            <Frame CornerRadius="10" Padding="15" BackgroundColor="White">
                <Grid RowDefinitions="Auto,Auto" ColumnDefinitions="Auto,*,Auto">
                    <Image Grid.RowSpan="2" Source="adobe.png" HeightRequest="45" WidthRequest="45" 
                           Margin="0,0,15,0" Aspect="AspectFit"/>
                    <Label Grid.Column="1" Text="Adobe Creative Cloud" FontAttributes="Bold" TextColor="Black" FontSize="16"/>
                    <Label Grid.Column="1" Grid.Row="1" Text="Renews 1 May, 2024" TextColor="#666" FontSize="12"/>
                    <Label Grid.Column="2" Grid.RowSpan="2" Text="Â£45" FontAttributes="Bold" TextColor="Black" 
                          VerticalOptions="Center" FontSize="16"/>
                </Grid>
            </Frame>

            <!-- Monthly Spending Section with Syncfusion Chart -->
            <Frame CornerRadius="10" Padding="15" BackgroundColor="White">
                <StackLayout>
                    <Label Text="Monthly Spending" FontSize="22" FontAttributes="Bold" HorizontalOptions="Center" Margin="0,0,0,5"/>
                    <Label Text="Last 6 months" TextColor="#666" FontSize="14" HorizontalOptions="Center" Margin="0,0,0,15"/>

                    <syncfusion:SfCartesianChart HeightRequest="200">
                        <syncfusion:SfCartesianChart.XAxes>
                            <syncfusion:CategoryAxis>
                                <syncfusion:CategoryAxis.Title>
                                    <syncfusion:ChartAxisTitle Text="Month"/>
                                </syncfusion:CategoryAxis.Title>
                            </syncfusion:CategoryAxis>
                        </syncfusion:SfCartesianChart.XAxes>

                        <syncfusion:SfCartesianChart.YAxes>
                            <syncfusion:NumericalAxis>
                                <syncfusion:NumericalAxis.Title>
                                    <syncfusion:ChartAxisTitle Text="Amount (Â£)"/>
                                </syncfusion:NumericalAxis.Title>
                            </syncfusion:NumericalAxis>
                        </syncfusion:SfCartesianChart.YAxes>

                        <syncfusion:SfCartesianChart.Series>
                            <syncfusion:ColumnSeries ItemsSource="{Binding MonthlySpendingData}" 
                                              XBindingPath="Month" 
                                              YBindingPath="Amount" 
                                              Fill="#6f61ef">
                            </syncfusion:ColumnSeries>
                        </syncfusion:SfCartesianChart.Series>
                    </syncfusion:SfCartesianChart>
                </StackLayout>
            </Frame>

            <!-- View Detailed Analytics Button -->
            <Button Text="View Detailed Analytics" 
                   BackgroundColor="#6f61ef" 
                   TextColor="White" 
                   CornerRadius="25" 
                   HeightRequest="50"
                   FontAttributes="Bold" 
                   Margin="40,10"
                   Clicked="ViewDetailedAnalytics_Clicked"/>

            
        </StackLayout>
    </ScrollView>
</ContentPage>