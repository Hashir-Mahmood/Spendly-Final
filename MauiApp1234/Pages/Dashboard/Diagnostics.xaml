<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="MauiApp1234.Pages.Dashboard.Diagnostics"
             BackgroundColor="#f4f6f9"
             xmlns:chart="clr-namespace:Syncfusion.Maui.Charts;assembly=Syncfusion.Maui.Charts"
             xmlns:local="clr-namespace:MauiApp1234.Pages.Dashboard"
             NavigationPage.HasNavigationBar="False"
             Shell.NavBarIsVisible="False">
    <Grid RowDefinitions="Auto,Auto,*,Auto">
        <ScrollView Grid.Row="2">
		<VerticalStackLayout Padding="20" Spacing="20">

			<Label Text="Financial Diagnostics" FontSize="28" FontAttributes="Bold" HorizontalOptions="Center" Margin="0,10,0,10"/>

			<Frame CornerRadius="10" Padding="15" BackgroundColor="White" BorderColor="LightGray" HasShadow="True">
				<VerticalStackLayout>
					<Label Text="Track your financial data over time" FontSize="14" TextColor="Gray" HorizontalOptions="Center" Margin="0,0,0,10"/>
					<HorizontalStackLayout HorizontalOptions="Center" Spacing="20">
						<RadioButton Content="Week" GroupName="TimePeriod" CheckedChanged="OnTimePeriodChanged" AutomationId="WeekRadio"/>
						<RadioButton Content="Month" GroupName="TimePeriod" IsChecked="True" CheckedChanged="OnTimePeriodChanged" AutomationId="MonthRadio"/>
						<RadioButton Content="Year" GroupName="TimePeriod" CheckedChanged="OnTimePeriodChanged" AutomationId="YearRadio"/>
					</HorizontalStackLayout>
				</VerticalStackLayout>
			</Frame>

			<Frame CornerRadius="10" Padding="15" BackgroundColor="White" BorderColor="LightGray" HasShadow="True">
				<VerticalStackLayout>
					<Label Text="Income Breakdown" FontSize="22" FontAttributes="Bold" HorizontalOptions="Center"/>
					<Label Text="Track your income split across accounts" FontSize="14" TextColor="Gray" HorizontalOptions="Center" Margin="0,5,0,15"/>

					<VerticalStackLayout Spacing="10" x:Name="IncomeBreakdownLayout" MinimumHeightRequest="50">
						<ActivityIndicator IsRunning="True" Color="#6f61ef" Margin="0,20"/>
						<Label Text="Loading income data..." HorizontalOptions="Center" TextColor="Gray"/>
					</VerticalStackLayout>

					<Button Text="+ Add New Account" TextColor="White" BackgroundColor="#6f61ef" BorderColor="Transparent" BorderWidth="0" CornerRadius="20" FontAttributes="Bold" HorizontalOptions="Center" Margin="0,15,0,0" Clicked="OnAddNewAccountClicked"/>
				</VerticalStackLayout>
			</Frame>

			<Frame CornerRadius="10" Padding="15" BackgroundColor="White" BorderColor="LightGray" HasShadow="True">
				<VerticalStackLayout>
					<Label Text="Expense Breakdown" FontSize="22" FontAttributes="Bold" HorizontalOptions="Center"/>
					<Label Text="Track your expenses across categories" FontSize="14" TextColor="Gray" HorizontalOptions="Center" Margin="0,5,0,15"/>

					
					<ScrollView Orientation="Horizontal" HorizontalScrollBarVisibility="Never" Margin="0,0,0,15">
                        <HorizontalStackLayout Spacing="8" x:Name="CategoryChipsLayout">
                        </HorizontalStackLayout>
					</ScrollView>

					<chart:SfCircularChart HeightRequest="250" Margin="0,0,0,15" x:Name="ExpensePieChart">
						<chart:SfCircularChart.Legend>
							<chart:ChartLegend/>
						</chart:SfCircularChart.Legend>
						<chart:SfCircularChart.Series>
							<chart:PieSeries ShowDataLabels="True"
                                             EnableTooltip="True"
                                             ExplodeIndex="0" ExplodeRadius="10"
                                             x:Name="ExpensePieSeries"
                                             XBindingPath="Category"  YBindingPath="Amount">
								<chart:PieSeries.PaletteBrushes>
									<SolidColorBrush Color="#8A2BE2"/>
									<SolidColorBrush Color="#BA55D3"/>
									<SolidColorBrush Color="#9370DB"/>
									<SolidColorBrush Color="#DA70D6"/>
									<SolidColorBrush Color="#EE82EE"/>
									<SolidColorBrush Color="#DDA0DD"/>
									<SolidColorBrush Color="#9966CC"/>
									<SolidColorBrush Color="#C8A2C8"/>
									<SolidColorBrush Color="#E6E6FA"/>
									<SolidColorBrush Color="#7B68EE"/>
									<SolidColorBrush Color="#6A5ACD"/>
									<SolidColorBrush Color="#483D8B"/>
								</chart:PieSeries.PaletteBrushes>
								<chart:PieSeries.DataLabelSettings>
									<chart:CircularDataLabelSettings LabelPlacement="Outer" UseSeriesPalette="False">
										<chart:CircularDataLabelSettings.LabelStyle>
											<chart:ChartDataLabelStyle LabelFormat="0" FontSize="10" TextColor="Black"/>
										</chart:CircularDataLabelSettings.LabelStyle>
									</chart:CircularDataLabelSettings>
								</chart:PieSeries.DataLabelSettings>
							</chart:PieSeries>
						</chart:SfCircularChart.Series>
					</chart:SfCircularChart>

					<VerticalStackLayout Spacing="10" x:Name="ExpenseBreakdownLayout" MinimumHeightRequest="100">
						<ActivityIndicator IsRunning="True" Color="#6f61ef" Margin="0,20"/>
						<Label Text="Loading expense data..." HorizontalOptions="Center" TextColor="Gray"/>
					</VerticalStackLayout>
				</VerticalStackLayout>
			</Frame>

			<Frame x:Name="CategoryPickerPopup" IsVisible="false" BackgroundColor="White" CornerRadius="10" Padding="15" Margin="20,0" BorderColor="LightGray" HasShadow="True">
				<Grid RowDefinitions="Auto,Auto,Auto" RowSpacing="15">
					<Label Grid.Row="0" Text="Add Categories" FontAttributes="Bold" HorizontalOptions="Center"/>
					<Grid Grid.Row="1" RowDefinitions="Auto,Auto,Auto,Auto" ColumnDefinitions="*,*,*" RowSpacing="15" ColumnSpacing="10">
						<HorizontalStackLayout Grid.Row="0" Grid.Column="0" Spacing="5">
							<CheckBox x:Name="SavingCheckbox" />
							<Label Text="Saving" VerticalOptions="Center"/>
						</HorizontalStackLayout>
						<HorizontalStackLayout Grid.Row="0" Grid.Column="1" Spacing="5">
							<CheckBox x:Name="HealthCheckbox" />
							<Label Text="Health" VerticalOptions="Center"/>
						</HorizontalStackLayout>
						<HorizontalStackLayout Grid.Row="0" Grid.Column="2" Spacing="5">
							<CheckBox x:Name="TransferCheckbox"/>
							<Label Text="Transfer" VerticalOptions="Center"/>
						</HorizontalStackLayout>
						<HorizontalStackLayout Grid.Row="1" Grid.Column="0" Spacing="5">
							<CheckBox x:Name="GamblingCheckbox" />
							<Label Text="Gambling" VerticalOptions="Center"/>
						</HorizontalStackLayout>
						<HorizontalStackLayout Grid.Row="1" Grid.Column="1" Spacing="5">
							<CheckBox x:Name="LifeEventCheckbox" />
							<Label Text="Life Event" VerticalOptions="Center"/>
						</HorizontalStackLayout>
						<HorizontalStackLayout Grid.Row="1" Grid.Column="2" Spacing="5">
							<CheckBox x:Name="MonthlyFeesCheckbox" />
							<Label Text="Monthly fees" VerticalOptions="Center"/>
						</HorizontalStackLayout>
						<HorizontalStackLayout Grid.Row="2" Grid.Column="0" Spacing="5">
							<CheckBox x:Name="InterestCheckbox" />
							<Label Text="Interest" VerticalOptions="Center"/>
						</HorizontalStackLayout>
						<HorizontalStackLayout Grid.Row="2" Grid.Column="1" Spacing="5">
							<CheckBox x:Name="WithdrawalCheckbox" />
							<Label Text="Withdrawal" VerticalOptions="Center"/>
						</HorizontalStackLayout>
						<HorizontalStackLayout Grid.Row="2" Grid.Column="2" Spacing="5">
							<CheckBox x:Name="MonthlyIncomeCheckbox" />
							<Label Text="Monthly income" VerticalOptions="Center"/>
						</HorizontalStackLayout>
					</Grid>
					<HorizontalStackLayout Grid.Row="2" HorizontalOptions="Center" Spacing="20" Margin="0,10,0,0">
						<Button Text="Cancel" CornerRadius="20" BackgroundColor="LightGray" TextColor="Black" Clicked="OnCancelCategorySelection"/>
						<Button Text="Add Selected" CornerRadius="20" BackgroundColor="#6f61ef" TextColor="White" Clicked="OnAddSelectedCategories"/>
					</HorizontalStackLayout>
				</Grid>
			</Frame>

                <Frame CornerRadius="10" Padding="15" BackgroundColor="White" BorderColor="LightGray" HasShadow="True">
                    <Grid>
                        <!-- Main layout content -->
                        <VerticalStackLayout>
                            <Label Text="Financial Summary" FontSize="22" FontAttributes="Bold" HorizontalOptions="Center"/>
                            <Label Text="Monthly overview" FontSize="14" TextColor="Gray" HorizontalOptions="Center" Margin="0,5,0,15"/>

                            <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto" RowSpacing="15" ColumnSpacing="15">
                                <Frame Grid.Row="0" Grid.Column="0" BackgroundColor="#e8f5e9" Padding="15" CornerRadius="10" BorderColor="#c8e6c9">
                                    <VerticalStackLayout Spacing="5">
                                        <Label Text="Income" FontAttributes="Bold" HorizontalOptions="Center" FontSize="14"/>
                                        <Label x:Name="TotalIncomeLabel"
                               Text="Loading..." TextColor="#2e7d32" FontSize="20"
                               FontAttributes="Bold"
                               HorizontalOptions="Center"/>
                                    </VerticalStackLayout>
                                </Frame>

                                <Frame Grid.Row="0" Grid.Column="1" BackgroundColor="#ffebee" Padding="15" CornerRadius="10" BorderColor="#ffcdd2">
                                    <VerticalStackLayout Spacing="5">
                                        <Label Text="Total Expenses" FontAttributes="Bold" HorizontalOptions="Center" FontSize="14"/>
                                        <Label x:Name="TotalExpensesLabel"
                               Text="Loading..." TextColor="#c62828" FontSize="20"
                               FontAttributes="Bold"
                               HorizontalOptions="Center"/>
                                    </VerticalStackLayout>
                                </Frame>

                                <Frame Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" BackgroundColor="#e3f2fd" Padding="15" CornerRadius="10" BorderColor="#bbdefb">
                                    <VerticalStackLayout Spacing="5">
                                        <Label Text="Net Cash Flow" FontAttributes="Bold" HorizontalOptions="Center" FontSize="16"/>
                                        <Label x:Name="NetCashFlowLabel"
                               Text="Loading..." TextColor="#1565c0" FontSize="24"
                               FontAttributes="Bold"
                               HorizontalOptions="Center"/>
                                    </VerticalStackLayout>
                                </Frame>
                            </Grid>
                        </VerticalStackLayout>

                        <!-- Pencil emoji in top-right corner -->
                        <Label Text="✏️"
       FontSize="20"
       HorizontalOptions="End"
       VerticalOptions="Start"
       Margin="0">
                            <Label.GestureRecognizers>
                                <TapGestureRecognizer Tapped="TapGestureRecognizer_Tapped" />
                            </Label.GestureRecognizers>
                        </Label>

                    </Grid>
                </Frame>


            </VerticalStackLayout>
	</ScrollView>
        <!-- Bottom Navigation -->
        <Grid Grid.Row="3" BackgroundColor="White" HeightRequest="60" ColumnDefinitions="*,*,*,*">
            <!-- return button -->
            <Button Text="←" 
FontSize="20" 
HorizontalOptions="Start" 
WidthRequest="40" 
HeightRequest="40" 
CornerRadius="20" 
BackgroundColor="Transparent" 
TextColor="Black" 
Padding="0" 
BorderWidth="0"
x:Name="ReturnButton"
Clicked="ReturnButton_Clicked"/>
        </Grid>
    </Grid>
</ContentPage>
